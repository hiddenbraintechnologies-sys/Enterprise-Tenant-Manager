‚úÖ STEP 1 (DO THIS FIRST)
DB + Backend validation for feature_flags & limits
üéØ Goal

Ensure no invalid plan can ever be saved (security + billing correctness).

Replit Prompt
Add backend validation for pricing plan feature_flags and limits.

Requirements:
1) Create a single source of truth:
   - FEATURE_CATALOG (allowed feature keys)
   - LIMIT_CATALOG (allowed limit keys)

Example:
FEATURE_CATALOG = [
  "consulting",
  "software_services",
  "invoicing",
  "gst_features",
  "email_notifications",
  "sms_notifications",
  "whatsapp_automation",
  "analytics_basic",
  "analytics_advanced",
  "priority_support",
  "custom_roles"
]

LIMIT_CATALOG = [
  "users",
  "clients",
  "records",
  "projects",
  "invoices_per_month",
  "storage_mb"
]

2) Validate on plan CREATE & UPDATE:
   - Reject unknown feature keys
   - Reject unknown limit keys
   - Ensure all values are boolean (features)
   - Ensure limits are integers or -1 (Unlimited)
   - Ensure Free plan cannot enable:
     - software_services
     - invoicing
     - whatsapp_automation

3) India-specific enforcement:
   - country_code = "IN" ‚Üí currency_code MUST be "INR"
   - base_price must be 0 / 99 / 199 unless explicitly overridden by super admin

4) Add tests:
   - invalid feature key ‚Üí 400
   - invalid limit value ‚Üí 400
   - Free plan with software_services=true ‚Üí 400


‚úÖ This locks billing correctness forever.

‚úÖ STEP 2
Super Admin Plan Builder UI (checkbox ‚Üí JSON mapping)
üéØ Goal

Let Super Admin visually manage plans without touching JSON.

Replit Prompt
Enhance Super Admin Pricing Plan Builder UI.

Tasks:
1) Render feature_flags as grouped checkboxes:
   - Core Modules
   - Notifications
   - Analytics
   - Support

2) Render limits as numeric inputs:
   - Allow -1 with label "Unlimited"
   - Show helper text for each limit

3) Add safety UX:
   - Disable software_services checkbox when plan is Free
   - Show warning if downgrading removes active features from tenants

4) Show live preview:
   - "This plan enables: Consulting, Software Services, GST‚Ä¶"
   - "Limits: 3 users, 500 records"

5) Persist exactly to feature_flags & limits JSON

‚úÖ STEP 3
Upgrade / Downgrade UX copy (EN + HI)
üéØ Goal

Make plan changes crystal clear to users.

Upgrade Modal (Free ‚Üí Basic)

EN

Unlock Software Services
Get GST invoicing, projects, and analytics for just ‚Çπ99/month.

HI

Software Services ‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡§∞‡•á‡§Ç
‚Çπ99/‡§Æ‡§π‡•Ä‡§®‡•á ‡§Æ‡•á‡§Ç GST, Projects ‡§î‡§∞ Analytics ‡§™‡§æ‡§è‡§Ç‡•§

Downgrade Modal (Pro ‚Üí Basic)

EN

Downgrade scheduled
Your plan will change at the end of the billing cycle. No data will be lost.

HI

Downgrade ‡§∂‡•á‡§°‡•ç‡§Ø‡•Ç‡§≤ ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à
‡§Ü‡§™‡§ï‡§æ ‡§™‡•ç‡§≤‡§æ‡§® ‡§á‡§∏ ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•á ‡§Ö‡§Ç‡§§ ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•á‡§ó‡§æ‡•§ ‡§°‡•á‡§ü‡§æ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∞‡§π‡•á‡§ó‡§æ‡•§

Replit Prompt
Add bilingual upgrade/downgrade confirmation modals (EN + HI).

Rules:
- Upgrades ‚Üí immediate
- Downgrades ‚Üí apply at month-end
- Copy must differ for:
  - Free ‚Üí Basic
  - Basic ‚Üí Pro
  - Pro ‚Üí Basic

Ensure consistent CTA wording across /packages and dashboard upgrade banners.

‚úÖ STEP 4
Annual pricing discounts (Zoho-style)
üéØ Goal

Encourage early payment without confusing users.

Discount Rules (recommended)
Plan	Monthly	Yearly
Basic	‚Çπ99	‚Çπ999 (2 months free)
Pro	‚Çπ199	‚Çπ1999
UX Display

Toggle: Monthly / Yearly

Badge: ‚ÄúSave 17%‚Äù

Super Admin can change % later

Replit Prompt
Add annual billing support with configurable discounts.

Backend:
- pricing_plans.billing_cycle = monthly | yearly
- pricing_plans.discount_percent (nullable)

Frontend:
- Toggle Monthly / Yearly
- Show savings badge (no decimals)
- Yearly price = monthly * 12 * (1 - discount%)

Admin:
- Super Admin can edit discount %
- India plans default to 2 months free

Ensure Razorpay integration-ready (planId mapping).

‚úÖ STEP 5 (OPTIONAL BUT POWERFUL)
Hide vs Lock module behavior
Rule (recommended)

Free ‚Üí hide Software Services

Basic/Pro ‚Üí show

Direct URL access ‚Üí show LockedFeature page

Replit Prompt
Standardize module visibility rules:
- Sidebar hides modules not in plan
- Direct URL access shows LockedFeature component with upgrade CTA
- Do not show raw 403 pages to end users
