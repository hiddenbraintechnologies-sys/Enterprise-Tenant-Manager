Perfect. âœ…
Thatâ€™s a very mature SaaS decision, and your reasoning is spot-on.

Youâ€™ve cleanly separated operational actions from administrative cleanup, which is exactly how enterprise systems (Zoho, NetSuite, SAP) behave.

Hereâ€™s a final sanity check + a couple of tiny polish suggestions (optional).

Final behavior matrix (âœ… approved)
Deactivate / Reactivate

Requires active add-on (HRMS or Payroll)

Permission: staff:update

Purpose: operational state changes

Blocked when expired âœ…

This prevents â€œusing HR features without payingâ€ âœ”ï¸

Delete (hard delete)

No add-on required âœ…

Requires:

Tenant isolation (router-level)

requireMinimumRole("admin")

409 conflict if:

payroll

attendance

leave

timesheets

Purpose: data hygiene / cleanup

This allows:

cleaning test data

removing mistaken records

cleanup after subscription cancellation

Exactly right.

Security & compliance verdict

âœ”ï¸ No privilege escalation

Only admins can delete

Staff cannot bypass add-on gates

âœ”ï¸ No data leakage

Cross-tenant â†’ still 404

âœ”ï¸ No billing loophole

Operational changes still require active entitlement

âœ”ï¸ Regulatory safe

Historical data cannot be deleted once used

Youâ€™re solid here.

Optional polish (recommended but not required)
1ï¸âƒ£ Audit log clarity

When deleting without an active add-on, log it clearly:

event: "HR_EMPLOYEE_DELETED"
metadata: {
  cleanupAfterExpiry: true,
  addonActive: false
}


This is gold for:

support

disputes

enterprise audits

2ï¸âƒ£ UI copy tweak (important UX clarity)

When HRMS is expired:

Hide Deactivate / Reactivate

Keep Delete visible for admins, with tooltip:

â€œCleanup allowed even when HRMS subscription is inactive.â€

This prevents confusion like:

â€œWhy can I delete but not deactivate?â€

3ï¸âƒ£ HTTP test (1 extra test worth adding)
it("Admin can delete employee after HRMS expiry", async () => {
  // addon expired
  // admin user
  // no related records
  expect(res.status).toBe(200);
});


You already have 26 tests â€” this one completes the story.

Why this design is better than Zoho

Zoho often:

blocks delete entirely when subscription expires

forces support tickets

Your approach:

empowers admins

reduces support load

still enforces compliance

This is product-led thinking, not just engineering.

Final verdict

âœ… Approved as-is
ðŸŸ¢ Architecture is clean
ðŸŸ¢ Permissions are correct
ðŸŸ¢ Add-on enforcement is principled
ðŸŸ¢ Admin experience is excellen